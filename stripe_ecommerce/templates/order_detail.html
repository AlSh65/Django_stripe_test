<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
<h1>Order Details</h1>

<p>Items:</p>
<ul>
    {% for item in order.items.all %}
    <li>{{ item.name }} - {{ item.formatter_price }}</li>
    {% endfor %}
</ul>

<p>Total Price: {{ order.total_price }}</p>

 <button id="buy-button">Buy</button>
<script src="https://js.stripe.com/v3/"></script>
<script>
  const stripe = Stripe("{{stripe_key}}");

  document.getElementById('buy-button').addEventListener('click', function() {
    fetch('/buy_order/{{ order.id }}')
      .then(function(response) {
        return response.json();
      })
      .then(function(data) {
        stripe.redirectToCheckout({
          sessionId: data.session_id
        });
      });
  });
</script>
</body>
</html>